# ---------------- Request --------------------
from __future__ import annotations
from typing import Optional
from point import Point # skal rettes til rigtige navn nÃ¥r vi har point filen

class Request:
    WAITING = "WAITING"
    ASSIGNED = "ASSIGNED"
    PICKED = "PICKED"
    DELIVERED = "DELIVERED"
    EXPIRED = "EXPIRED"

    def __init__(self, id: int, pickup: Point, dropoff: Point, creation_time: int):
    self.id = int(id)
    self.pickup = pickup
    self.dropoff = dropoff
    self.creation_time = int(creation_time)
    self.status = Request.WAITING
    self.assigned_driver_id: Optional[int] = None
    self.wait_time: int = 0

    def is_active(self) -> bool:
        return self.status in (Request.WAITING, Request.ASSIGNED, Request.PICKED)

    def mark_assigned(self, driver_id: int) -> None:
        self.status = Request.ASSIGNED
        self.assigned_driver_id = int(driver_id)

    def mark_picked(self, t: int) -> None:
        self.status = Request.PICKED
        self.wait_time = int(t - self.creation_time)

    def mark_delivered(self, t: int) -> None:
        self.status = Request.DELIVERED

    def mark_expired(self, t: int) -> None:
        self.status = Request.EXPIRED

    def update_wait(self, current_time: int) -> None:
        if self.status in (Request.WAITING, Request.ASSIGNED):
            self.wait_time = int(current_time - self.creation_time)

    def __repr__(self):
        return f"Request(id={self.id}, status={self.status}, wait={self.wait_time}, pickup={self.pickup})"
